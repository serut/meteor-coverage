version: 2
orbs:
  browser-tools: circleci/browser-tools@1.1.0
jobs:
  build:
    docker:
      - image: cimg/node:20.16.0-browsers
    environment:
      NPM_CONFIG_PREFIX: "~/.npm-global"
    working_directory: ~/meteor-coverage
    steps:
      - checkout
      - run: echo 'export PATH=~/.npm-global/bin:$PATH' >> $BASH_ENV
      - run: npx meteor
      - run: meteor npm install
      - run: mkdir .coverage
      - run: meteor npm test
      - run: meteor npm run lint || true # ignore eslint error
